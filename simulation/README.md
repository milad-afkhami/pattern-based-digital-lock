# Simulation Files (`simulation/`)

This directory stores waveform files generated during simulation.

---

## Contents

After running testbenches, this directory contains `.ghw` waveform files:

| File | Source Testbench |
|------|------------------|
| `tb_digital_lock.ghw` | FSM unit tests |
| `tb_top_level.ghw` | Full system tests |
| `tb_fsm_coverage.ghw` | Coverage tests |
| `tb_edge_cases.ghw` | Edge case tests |
| `tb_debouncer.ghw` | Debouncer tests |

<details>
<summary>What are .ghw files?</summary>

GHW (GHDL Waveform) files contain signal values recorded during simulation. They're like a "flight recorder" that captures every signal transition, allowing you to analyze what happened during the test.

</details>

---

## Viewing Waveforms

### Open with GTKWave

```bash
# View any waveform file
gtkwave tb_digital_lock.ghw

# Or from project root
gtkwave simulation/tb_digital_lock.ghw
```

### GTKWave Quick Guide

1. **Add Signals**:
   - Left panel: Expand hierarchy (click `+`)
   - Double-click signal names to add them

2. **Navigate**:
   - Mouse wheel: Zoom in/out
   - Click timeline: Move cursor
   - Ctrl+click: Drop marker

3. **Useful Shortcuts**:
   - `+` / `-`: Zoom
   - `Home`: Go to start
   - `End`: Go to end
   - `Left`/`Right`: Move cursor

<details>
<summary>Recommended signal setup for debugging</summary>

For debugging the digital lock, add these signals:

```
tb_digital_lock
├── clk
├── reset
├── button_A
├── button_B
├── button_C
├── button_D
├── lock_status
└── uut (expand)
    ├── current_state
    ├── next_state
    ├── unlock_timer
    └── timer_expired
```

Save your signal layout: File → Write Save File

</details>

---

## Generating Waveforms

Waveforms are generated using the `--wave` flag:

```bash
ghdl -r --std=08 tb_digital_lock --wave=simulation/tb_digital_lock.ghw
```

### Other Output Options

```bash
# VCD format (more universal, larger files)
ghdl -r --std=08 tb_digital_lock --vcd=simulation/tb_digital_lock.vcd

# FST format (compressed, good for large designs)
ghdl -r --std=08 tb_digital_lock --fst=simulation/tb_digital_lock.fst
```

---

## Cleaning Up

Waveform files can be large. To clean:

```bash
# Remove all waveform files
rm simulation/*.ghw
rm simulation/*.vcd
rm simulation/*.fst
```

---

## File Sizes

Typical sizes for this project:

| Test | Duration | File Size |
|------|----------|-----------|
| tb_digital_lock | ~1μs | ~50 KB |
| tb_top_level | ~5μs | ~200 KB |
| tb_edge_cases | ~10μs | ~500 KB |

<details>
<summary>Reducing file sizes</summary>

For long simulations, file sizes can grow large. Options:

1. **Shorter simulations**: Use smaller timing values
2. **Fewer signals**: Use `--wave` with specific signals only
3. **FST format**: More compressed than GHW/VCD
4. **Don't save**: Skip `--wave` if you don't need it

</details>

---

## Note

This directory is typically `.gitignore`d since waveform files:
- Are generated, not source code
- Can be large
- Are easily regenerated by running simulations
